<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Sistem Pakar Mutu Biji Kopi</title>
  <link rel="icon" type="image/svg+xml" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 32 32'><ellipse fill='%236f4e37' cx='16' cy='16' rx='14' ry='10'/></svg>">
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/gsap@3.12.2/dist/gsap.min.js"></script>
  <script src="https://unpkg.com/lucide@latest"></script>
  <style>
    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(20px); }
      to { opacity: 1; transform: translateY(0); }
    }
    .fade-in {
      animation: fadeIn 0.8s ease-out;
    }
    /* Custom scrollbar for coffee vibes */
    ::-webkit-scrollbar {
      width: 8px;
      background: #c7a17a;
    }
    ::-webkit-scrollbar-thumb {
      background: #6f4e37;
      border-radius: 8px;
    }
    /* Tooltip */
    .tooltip {
      position: relative;
      cursor: pointer;
    }
    .tooltip .tooltiptext {
      visibility: hidden;
      width: max-content;
      background-color: #6f4e37;
      color: #ede0d4;
      text-align: left;
      border-radius: 8px;
      padding: 8px 14px;
      position: absolute;
      z-index: 10;
      bottom: 125%;
      left: 50%;
      transform: translateX(-50%);
      opacity: 0;
      font-size: 0.95rem;
      transition: opacity 0.3s;
      box-shadow: 0 2px 8px #6f4e3722;
      white-space: pre-line;
    }
    .tooltip:hover .tooltiptext {
      visibility: visible;
      opacity: 1;
    }
  </style>
</head>
<body class="bg-gradient-to-br from-[#6f4e37] via-[#c7a17a] to-[#ede0d4] min-h-screen flex items-center justify-center p-4">
  <div class="bg-[#ede0d4] shadow-2xl rounded-2xl p-8 w-full max-w-2xl transition-all duration-300 ease-in-out fade-in border-4 border-[#a47149]">
    <div class="flex flex-col items-center justify-center mb-8">
      <!-- Ganti bagian logo di dalam <div class="flex flex-col items-center ..."> -->
      <svg width="64" height="64" viewBox="0 0 64 64" fill="none" class="mb-2 drop-shadow" style="filter: drop-shadow(0 2px 8px #a4714944)">
        <ellipse cx="32" cy="32" rx="24" ry="16" fill="#6f4e37"/>
        <path d="M32 16 Q36 32 32 48" stroke="#ede0d4" stroke-width="3" stroke-linecap="round"/>
      </svg>
      <h2 class="text-3xl font-extrabold text-[#6f4e37] drop-shadow mb-1">Sistem Pakar Mutu Biji Kopi</h2>
      <span class="text-[#a47149] font-medium text-base">Penilaian mutu biji kopi secara cepat & mudah</span>
    </div>

    <form id="kopiForm" class="space-y-6">
      <div>
        <label class="block font-medium mb-1 text-[#6f4e37]">Standar Penilaian</label>
        <div id="segmented-standar" class="flex gap-2 mb-2 w-full">
          <button type="button" id="btnSNI" class="w-1/2 px-4 py-2 rounded-l-lg border border-[#a47149] bg-[#f5eee6] text-[#6f4e37] font-semibold focus:outline-none focus:ring focus:ring-[#c7a17a] active:bg-[#c7a17a]">SNI</button>
          <button type="button" id="btnSCAA" class="w-1/2 px-4 py-2 rounded-r-lg border border-[#a47149] bg-[#ede0d4] text-[#6f4e37] font-semibold focus:outline-none focus:ring focus:ring-[#c7a17a] active:bg-[#c7a17a]">SCAA</button>
        </div>
        <input type="hidden" id="standar" value="sni">
      </div>

      <div>
        <label class="block font-medium mb-1 text-[#6f4e37]">Ukuran Biji</label>
        <select id="ukuran" class="w-full border border-[#a47149] rounded-lg p-2 focus:ring focus:ring-[#c7a17a] bg-[#f5eee6] text-[#6f4e37]">
          <option value="besar">Besar (tertahan di saringan 7mm)</option>
          <option value="sedang">Sedang (tertahan di saringan 6mm)</option>
          <option value="kecil">Kecil (tertahan di saringan 5mm)</option>
        </select>
      </div>

      <div>
        <label class="block font-medium mb-1 text-[#6f4e37]">Warna Biji</label>
        <select id="warna" class="w-full border border-[#a47149] rounded-lg p-2 focus:ring focus:ring-[#c7a17a] bg-[#f5eee6] text-[#6f4e37]">
          <option value="hijau_kebiruan">Hijau Kebiruan</option>
          <option value="hijau_agak_kebiruan">Hijau Agak Kebiruan</option>
          <option value="hijau">Hijau</option>
          <option value="agak_hijau">Agak Hijau</option>
          <option value="hijau_kekuningan">Hijau Kekuningan</option>
          <option value="kuning_pucat">Kuning Pucat</option>
          <option value="agak_kuning">Agak Kuning</option>
          <option value="kecokelatan">Kecokelatan</option>
        </select>
      </div>

      <div>
        <label class="block font-medium mb-1 text-[#6f4e37]">Jumlah Cacat per 300g</label>
        <input type="number" id="cacat" min="0" max="100" value="0" class="w-full border border-[#a47149] rounded-lg p-2 focus:ring focus:ring-[#c7a17a] bg-[#f5eee6] text-[#6f4e37]">
      </div>

      <div>
        <label class="block font-medium mb-1 text-[#6f4e37]">Jenis Cacat</label>
        <div id="jenisCacatCheckboxes" class="flex flex-wrap gap-4">
          <label class="flex items-center text-[#6f4e37]"><input type="checkbox" value="pecah" class="mr-2 accent-[#a47149]">Biji Pecah</label>
          <label class="flex items-center text-[#6f4e37]"><input type="checkbox" value="hitam" class="mr-2 accent-[#a47149]">Hitam</label>
          <label class="flex items-center text-[#6f4e37]"><input type="checkbox" value="fermentasi" class="mr-2 accent-[#a47149]">Fermentasi</label>
          <label class="flex items-center text-[#6f4e37]"><input type="checkbox" value="Tidak Matang" class="mr-2 accent-[#a47149]">Tidak Matang</label>
          <label class="flex items-center text-[#6f4e37]"><input type="checkbox" value="Biji Kopong" class="mr-2 accent-[#a47149]">Biji Kopong</label>
        </div>
      </div>

      <div>
        <label class="block font-medium mb-1 text-[#6f4e37]">Kebersihan Biji</label>
        <select id="bersih" class="w-full border border-[#a47149] rounded-lg p-2 focus:ring focus:ring-[#c7a17a] bg-[#f5eee6] text-[#6f4e37]">
          <option value="bersih">Bersih</option>
          <option value="agak">Agak Kotor</option>
          <option value="kotor">Kotor</option>
        </select>
      </div>

      <div>
        <label class="block font-medium mb-1 text-[#6f4e37]">Kadar Air</label>
        <select id="air" class="w-full border border-[#a47149] rounded-lg p-2 focus:ring focus:ring-[#c7a17a] bg-[#f5eee6] text-[#6f4e37]">
          <option value="ideal">9â€“13% (Ideal / Standar SCAA)</option>
          <option value="lembab">&gt;13% (Lembab / Kelembapan Tinggi)</option>
          <option value="kering">&lt;9% (Terlalu Kering)</option>
        </select>
        <span class="text-xs text-[#a47149]">Pilih sesuai hasil pengukuran kadar air biji kopi Anda.</span>
      </div>

      <div>
        <label class="block font-medium mb-1 text-[#6f4e37]">Aroma Biji</label>
        <select id="aroma" class="w-full border border-[#a47149] rounded-lg p-2 focus:ring focus:ring-[#c7a17a] bg-[#f5eee6] text-[#6f4e37]">
          <option value="harum">Harum (reumputan dan kacang kacangan)</option>
          <option value="netral">Netral</option>
          <option value="menyengat">Menyengat (apek)</option>
        </select>
      </div>

      <div class="flex flex-col sm:flex-row gap-3 mt-2">
        <button type="button" onclick="analisaMutu()" class="w-full bg-[#6f4e37] text-[#ede0d4] py-3 px-6 rounded-lg font-semibold hover:bg-[#a47149] transition duration-300 flex items-center justify-center gap-2 shadow-lg">
          <i data-lucide="check-circle"></i>
          Analisa Mutu
        </button>
        <button type="reset" onclick="resetHasil()" class="w-full bg-[#c7a17a] text-[#6f4e37] py-3 px-6 rounded-lg font-semibold hover:bg-[#a47149] hover:text-white transition duration-300 flex items-center justify-center gap-2 shadow-lg border border-[#a47149]">
          <i data-lucide="rotate-ccw"></i>
          Reset
        </button>
      </div>
    </form>

    <div class="flex justify-center mt-4">
      <div class="tooltip text-[#6f4e37] text-sm font-medium flex items-center gap-1 cursor-pointer">
        <i data-lucide="info" class="w-4 h-4"></i>
        <span>Penjelasan Grade</span>
        <span class="tooltiptext">
          <b>GRADE A - PREMIUM</b>:<br>
          Warna ideal, cacat sangat sedikit, bersih, kadar air ideal, aroma harum.<br><br>
          <b>GRADE B - CUKUP BAIK</b>:<br>
          Cacat masih wajar, jenis cacat tidak terlalu banyak, kebersihan dan kadar air cukup dan tidak sampai kering sekali.<br><br>
          <b>GRADE C - PERLU SORTIR ULANG</b>:<br>
          Cacat banyak, jenis cacat banyak, kebersihan buruk, kadar air tinggi, aroma menyengat.
        </span>
      </div>
    </div>

    <div id="result" class="mt-8 p-4 bg-[#c7a17a]/30 border border-[#a47149] rounded text-[#6f4e37] hidden text-center text-lg font-semibold fade-in"></div>
  </div>

  <script>
    lucide.createIcons();

    // Script untuk disable checkbox jenis cacat jika jumlah cacat = 0
    document.getElementById("cacat").addEventListener("input", function() {
      const cacatValue = parseInt(this.value) || 0;
      const checkboxes = document.querySelectorAll('#jenisCacatCheckboxes input[type=checkbox]');
      checkboxes.forEach(cb => {
        cb.disabled = cacatValue === 0;
        if (cacatValue === 0) cb.checked = false;
      });
    });
    // Inisialisasi saat load pertama
    window.addEventListener("DOMContentLoaded", function() {
      const cacatInput = document.getElementById("cacat");
      const cacatValue = parseInt(cacatInput.value) || 0;
      const checkboxes = document.querySelectorAll('#jenisCacatCheckboxes input[type=checkbox]');
      checkboxes.forEach(cb => {
        cb.disabled = cacatValue === 0;
        if (cacatValue === 0) cb.checked = false;
      });
    });

    // Script untuk mengubah tampilan segmented control dan nilai standar
    const btnSNI = document.getElementById("btnSNI");
    const btnSCAA = document.getElementById("btnSCAA");
    const inputStandar = document.getElementById("standar");

    btnSNI.addEventListener("click", () => {
      btnSNI.classList.add("bg-[#f5eee6]", "text-[#6f4e37]", "font-semibold");
      btnSNI.classList.remove("bg-[#ede0d4]", "text-[#6f4e37]", "font-semibold");
      btnSCAA.classList.remove("bg-[#f5eee6]", "text-[#6f4e37]", "font-semibold");
      btnSCAA.classList.add("bg-[#ede0d4]", "text-[#6f4e37]", "font-semibold");
      inputStandar.value = "sni";
    });

    btnSCAA.addEventListener("click", () => {
      btnSCAA.classList.add("bg-[#f5eee6]", "text-[#6f4e37]", "font-semibold");
      btnSCAA.classList.remove("bg-[#ede0d4]", "text-[#6f4e37]", "font-semibold");
      btnSNI.classList.remove("bg-[#f5eee6]", "text-[#6f4e37]", "font-semibold");
      btnSNI.classList.add("bg-[#ede0d4]", "text-[#6f4e37]", "font-semibold");
      inputStandar.value = "scaa";
    });

    // Segmented button logic
    document.getElementById("btnSNI").addEventListener("click", function() {
      document.getElementById("standar").value = "sni";
      this.classList.add("bg-[#f5eee6]");
      this.classList.remove("bg-[#ede0d4]");
      document.getElementById("btnSCAA").classList.remove("bg-[#f5eee6]");
      document.getElementById("btnSCAA").classList.add("bg-[#ede0d4]");
    });
    document.getElementById("btnSCAA").addEventListener("click", function() {
      document.getElementById("standar").value = "scaa";
      this.classList.add("bg-[#f5eee6]");
      this.classList.remove("bg-[#ede0d4]");
      document.getElementById("btnSNI").classList.remove("bg-[#f5eee6]");
      document.getElementById("btnSNI").classList.add("bg-[#ede0d4]");
    });

    function analisaMutu() {
      const standar = document.getElementById("standar").value;
      const ukuran = document.getElementById("ukuran").value;
      const warna = document.getElementById("warna").value;
      const cacat = parseInt(document.getElementById("cacat").value);
      const jenisCacat = [...document.querySelectorAll('#jenisCacatCheckboxes input[type=checkbox]:checked')].map(cb => cb.value);
      const bersih = document.getElementById("bersih").value;
      const air = document.getElementById("air").value;
      const aroma = document.getElementById("aroma").value;

      let grade = "";

      if (standar === "sni") {
        // Penilaian SNI
        if (
          cacat <= 11 &&
          (ukuran === "besar" || ukuran === "sedang") &&
          (warna === "hijau_kebiruan" || warna === "hijau_agak_kebiruan" || warna === "hijau") &&
          jenisCacat.length <= 1 &&
          (bersih === "bersih" || bersih === "agak") &&
          air === "ideal" &&
          (aroma === "harum" || aroma === "netral")
        ) {
          grade = `<span class="inline-block px-3 py-1 rounded-full bg-green-200 text-green-800 font-bold text-xl shadow">GRADE A (SNI)</span>`;
        } else if (
          (
            cacat <= 25 &&
            ukuran !== "kecil" &&
            warna !== "kecokelatan" &&
            jenisCacat.length <= 2 &&
            bersih !== "kotor" &&
            air !== "lembab" &&
            aroma !== "menyengat"
          )
          ||
          (
            ukuran === "kecil" &&
            cacat <= 11 &&
            (warna === "hijau_kebiruan" || warna === "hijau_agak_kebiruan" || warna === "hijau") &&
            jenisCacat.length <= 1 &&
            (bersih === "bersih" || bersih === "agak") &&
            air === "ideal" &&
            (aroma === "harum" || aroma === "netral")
          )
        ) {
          grade = `<span class="inline-block px-3 py-1 rounded-full bg-yellow-200 text-yellow-800 font-bold text-xl shadow">GRADE B (SNI)</span>`;
        } else {
          grade = `<span class="inline-block px-3 py-1 rounded-full bg-red-200 text-red-800 font-bold text-xl shadow">GRADE C (SNI)</span>`;
        }
      } else {
        // Penilaian SCAA
        if (
          cacat <= 5 &&
          ukuran === "besar" &&
          (warna === "hijau_kebiruan" || warna === "hijau") &&
          jenisCacat.length === 0 &&
          bersih === "bersih" &&
          air === "ideal" &&
          aroma === "harum"
        ) {
          grade = `<span class="inline-block px-3 py-1 rounded-full bg-green-200 text-green-800 font-bold text-xl shadow">GRADE A (SCAA)</span>`;
        } else if (
          cacat <= 8 &&
          ukuran !== "kecil" &&
          (warna === "hijau_kebiruan" || warna === "hijau" || warna === "agak_hijau") &&
          jenisCacat.length <= 1 &&
          bersih !== "kotor" &&
          air === "ideal" &&
          aroma !== "menyengat"
        ) {
          grade = `<span class="inline-block px-3 py-1 rounded-full bg-yellow-200 text-yellow-800 font-bold text-xl shadow">GRADE B (SCAA)</span>`;
        } else {
          grade = `<span class="inline-block px-3 py-1 rounded-full bg-red-200 text-red-800 font-bold text-xl shadow">GRADE C (SCAA)</span>`;
        }
      }

      const resultDiv = document.getElementById("result");
      resultDiv.innerHTML = `<strong>Hasil Penilaian:</strong><br>${grade}`;
      resultDiv.classList.remove("hidden");

      gsap.fromTo(resultDiv, { opacity: 0, y: 20 }, { opacity: 1, y: 0, duration: 1 });
    }

    function resetHasil() {
      const resultDiv = document.getElementById("result");
      resultDiv.classList.add("hidden");
      resultDiv.innerHTML = "";
    }
  </script>
</body>
</html>
